メルカリテックカンファレンス2018は「さくらインターネットを卒業してGoogleに移行するぜ」みたいな会だった。

<p>メルカリテックカンファレンスに入ってきました。午後のカンファレンスの中心になったのは
マイクロサービスです。メルカリにとってmicroserviceへの移行というのはさくらインターネットから 
Google にインフラに移行するということです。日本では「スタートアップの最初はさくらインターネット」という伝統もありますから、
メルカリも大きくなったので「卒業」したんだと思います（上から目線ｗ）。</p>

<p>さくらインターネットが「なんの変哲もない素のIaaSクラウドサーバーを安く提供する」という方針は
たしかにコストメリットはあるのですが、会社が大きくなったときには向かないのかもしれません。
これは「葉っぱと泥付きの有機栽培の大根を安く売る」のに似ています。レストラン経営に例えましょう。
小さいレストランを経営しているときは、さくらさんから「安い葉っぱと泥付きの有機栽培の大根」を
購入するとコストメリットもあってよいのですが、レストランの経営が大きくなって、
チェーン店もたくさんできると給料の高い多数の従業員に大根の泥を洗ってもらうのは、
コストメリットもスケールメリットもないです。そこで、Googleさんから調理済みのカット野菜を仕入れて、
従業員は調理と接客に専念してもらう方式に変えた感じです。多くの語弊はありますが、
まぁ、そんな感じです。
実際は、カット野菜どころでないドラスティックな大変更なので、聞いてて、大変そうだと思いました。
すでに大規模に運用したサービスでここまでの変更を判断した人も偉いし、実装した人もすごいです。
</p>

<p>元々メルカリは 噂によるとAWS で実装されておりました。しかしいろんなアレや価格の問題でさくらインターネットに移行し、コストを大幅に下げたという噂を聞いています。しかしながら、さくらインターネットのサーバーで PHP でモノリスにゴリゴリ作ると小さなチームでは非常にコストパフォーマンスもよく問題はないのですが、現在メルカリは300人を超えるエンジニアもいて、これでは回らなくなってしまいました。デプロイだけで死にそうですね。また、最近のトレンドとしてはモノリシックにPHPでゴリゴリはかっこよくないですし、採用的にもいい人が集まりません。そこで GKE / GCP / golang / GRPC / microseviceを中心とした今っぽい構成に移行することになりました。ガッツリGoogleですね。ただ、ガチでベンダーロックするものを選んでないのはすごいなぁと思いました。ここ最近のトレンドとして意識高いエンジニアの間では AWS よりも GCPやFirebase を使ったほうがかっこいいという方向に行っています。Firebaseの一部のサービスは、まだ発展途上で、危なっかしいので、お金が絡むサービスにはまだまだ不向きかなぁと思ってます。</p>

<p>これは経営陣もちょっと考えなくちゃいけないことです。PL脳で経営のことを考えると、できるだけ古い技術や使い潰した技術を使った方がコストが安く済むことが多いです。また、オッサンエンジニアも同じようなことを考えてしまいます。PHPの資産が捨てれないとかいう気持ちもわかります。しかしながら、フレキシビリティないので長期的にはつぶれますし、保守性もないし、拡張性もすぐ壁が来ます。最近のイケてるエンジニアは流行りが大好きなのでレガシーな技術ばっかり使っているとだんだん人が離れていきますし、採用を難しくなっていきます。特に日本は広告で上場したベンチャーが多いですがそういった社長さんが経営する会社は多くの場合 PL 脳で考えているのでこういったことに頭が回らない気がします。</p>

<p>ただ、microservice万歳かというと、個人的にはそう思ってないです。メルカリみたいにエンジニアが多いときは、microservice万歳ですが、小さなチームで機能も少なくて予算もないときはそうでもないと思ってます。コストだけ考えるとVPSを使ったほうがいいケースもかなりたくさんあります。個人的にはAWS lamdaやFirebase functionsに注目してますが、安定性と速度とコストメリットがイマイチなんですが、まだまだ検討中です。</p>

<p>この辺の話をすると、話が尽きないので、このへんで。</p>

<p>たぶん。さくらインターネットさん、<a href=”https://weekly.ascii.jp/elem/000/000/419/419034/”>先日の北海道地震でも、停電中を発電機で乗り切ったサーバー運用ドラマは称賛するべき。映画化希望。</a></p>

